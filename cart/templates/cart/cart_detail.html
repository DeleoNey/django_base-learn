{% extends "main/base.html" %}

{% block title %}–ö–æ—Ä–∑–∏–Ω–∞{% endblock title %}

{% block content %}
<div class="container">
  <h2 class="mb-4">–ú–æ—è –∫–æ—Ä–∑–∏–Ω–∞</h2>

  {% if cart %}
  <div class="table-responsive">
    <table class="table table-striped align-middle text-center">
      <thead class="table-dark">
        <tr>
          <th>–¢–æ–≤–∞—Ä</th>
          <th>–ö—ñ–ª—å–∫—ñ—Å—Ç—å</th>
          <th>–¶—ñ–Ω–∞ –∑–∞ –æ–¥–∏–Ω–∏—Ü—é</th>
          <th>–†–∞–∑–æ–º</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        {% for item in cart %}
        {% with product=item.product %}
        <tr>
          <td>
            <a href="{% url 'main:product_detail' product.id product.slug %}">
              {{ product.name }}
            </a>
          </td>
          <td>
            <!-- –§–æ—Ä–º–∞ –¥–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –∫—ñ–ª—å–∫–æ—Å—Ç—ñ -->
            <form action="{% url 'cart:cart_add' product.id %}" method="post" class="d-flex justify-content-center">
              {% csrf_token %}
              {{ item.update_quantity_form.quantity }}
              {{ item.update_quantity_form.override }}
              <button type="submit" class="btn btn-sm btn-outline-primary ms-2">–û–Ω–æ–≤–∏—Ç–∏</button>
            </form>
          </td>
          <td>{{ item.price }} ‚Ç¥</td>
          <td>{{ item.total_price }} ‚Ç¥</td>
          <td>
            <!-- –ö–Ω–æ–ø–∫–∞ –≤–∏–¥–∞–ª–µ–Ω–Ω—è -->
            <form action="{% url 'cart:cart_remove' product.id %}" method="post">
              {% csrf_token %}
              <button type="submit" class="btn btn-sm btn-danger">–í–∏–¥–∞–ª–∏—Ç–∏</button>
            </form>
          </td>
        </tr>
        {% endwith %}
        {% endfor %}
      </tbody>
    </table>
  </div>

  <!-- –ü—ñ–¥—Å—É–º–æ–∫ -->
  <div class="text-end mt-3">
    <h4>–í—Å—å–æ–≥–æ: <span class="text-success">{{ cart.get_total_price }} ‚Ç¥</span></h4>
  </div>

  <div class="d-flex justify-content-between mt-4">
    <a href="{% url 'main:product_list' %}" class="btn btn-outline-secondary">
      –ü—Ä–æ–¥–æ–≤–∂–∏—Ç–∏ –ø–æ–∫—É–ø–∫–∏
    </a>
    <a href="#" class="btn btn-success">–û—Ñ–æ—Ä–º–∏—Ç–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è</a>
  </div>

  {% else %}
  <div class="alert alert-warning text-center" role="alert">
    –í–∞—à–∞ –∫–æ—Ä–∑–∏–Ω–∞ –ø–æ—Ä–æ–∂–Ω—è üôÅ
  </div>
  <div class="text-center">
    <a href="{% url 'main:product_list' %}" class="btn btn-primary">–ü–µ—Ä–µ–π—Ç–∏ –¥–æ –ø–æ–∫—É–ø–æ–∫</a>
  </div>
  {% endif %}
</div>
{% endblock content %}
