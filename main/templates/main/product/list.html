{% extends "main/base.html" %}

{% block title %}
    {% if category %}{{ category.name }}{% else %}Список товарів{% endif %}
{% endblock title %}

{% block content %}
<div class="row">
  <!-- Бічне меню категорій -->
  <div class="col-md-3">
    <h5>Категорії</h5>
    <ul class="list-group">
      <li class="list-group-item {% if not category %}active{% endif %}">
        <a href="{% url 'main:product_list' %}" class="text-decoration-none {% if not category %}text-light{% endif %}">
          Всі товари
        </a>
      </li>
      {% for c in categories %}
      <li class="list-group-item {% if category and category.slug == c.slug %}active{% endif %}">
        <a href="{{ c.get_absolute_url }}" class="text-decoration-none {% if category and category.slug == c.slug %}text-light{% endif %}">
          {{ c.name }}
        </a>
      </li>
      {% endfor %}
    </ul>
  </div>

  <!-- Список товарів -->
  <div class="col-md-9">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <h3>
        {% if category %}
          {{ category.name }}
        {% else %}
          Всі товари
        {% endif %}
      </h3>

      <!-- Dropdown сортування -->
      <div class="dropdown">
        <button class="btn btn-outline-secondary dropdown-toggle" type="button" id="sortMenu" data-bs-toggle="dropdown" aria-expanded="false">
          Сортувати
        </button>
        <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="sortMenu">
          <li><a class="dropdown-item" href="?sort=name">За назвою (А-Я)</a></li>
          <li><a class="dropdown-item" href="?sort=-name">За назвою (Я-А)</a></li>
          <li><a class="dropdown-item" href="?sort=price">За ціною (зрост.)</a></li>
          <li><a class="dropdown-item" href="?sort=-price">За ціною (спад.)</a></li>
          <li><a class="dropdown-item" href="?sort=-created">Нові спочатку</a></li>
          <li><a class="dropdown-item" href="?sort=created">Старі спочатку</a></li>
        </ul>
      </div>
    </div>

      <div class="row">
  {% for product in products %}
  <div class="col-md-4 mb-4">
    <div class="card h-100">
      {% if product.image %}
      <img src="{{ product.image.url }}" class="card-img-top" alt="{{ product.name }}">
      {% else %}
      <img src="" class="card-img-top" alt="No image">
{#          {% static 'img/no_image.png' %}#}
      {% endif %}
      <div class="card-body d-flex flex-column">
        <h5 class="card-title">{{ product.name }}</h5>
        <p class="card-text text-truncate">{{ product.description|default:"Без опису" }}</p>
        <div class="mt-auto">
          <p class="fw-bold">{{ product.price }} ₴</p>
          <a href="{{ product.get_absolute_url }}" class="btn btn-primary btn-sm">Детальніше</a>
        </div>
      </div>
    </div>
  </div>
  {% empty %}
  <div class="col-12">
    <div class="alert alert-warning text-center" role="alert">
      Товари відсутні у цій категорії.
    </div>
  </div>
  {% endfor %}
</div>

</div>
{% endblock content %}
